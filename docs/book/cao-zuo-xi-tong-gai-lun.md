---
password: systeM
---

# 操作系统概论

> 作业ip：https://10.11.119.115 / http://10.11.119.115:8234 [内网访问]
>
> - 初始用户及密码均为学号
>
> 评分标准：
>
> - 出勤率+作业+课堂表现     20%
> - 平时测验（每次5%，共8次） 40%
> - 

## IO结构

> CPU、内存与I/O设备间的操作速率相差甚远，因此存在2中I/O结构

![img](https://gitee.com/yzketx/image-markdown/raw/master/img/202203011048058.png)

### 两种I/O结构

- 同步I/O：I/O启动后，只有当I/O完成后控制权才返回给用户进程。

  - wait指令，使CPU空闲直到下一个中断开始
  - 循环等待
  - 在任何时候最多只能处理一个I/O请求

- 异步I/O：I/O启动后，控制权无须等待I/O操作完成就可返回给用户进程。

  - 系统调用 － 请求OS允许用户等待I/O操作的完成
  - 设备状态表包含了每个I/O设备的一个条目，用来指示该设备的类型、 地址和状态（不工作、空闲或繁忙）
  - OS通过查询I/O设备表来判断设备的状态，并修改该条目，以反映出现中断

  ![image-20220301100257102](https://gitee.com/yzketx/image-markdown/raw/master/img/202203011003197.png)

### 外部接口的IO操作模式

> `内存`：CPU可以直接访问，不需要通过接口
>
> `I/O设备`：需要通过被CPU访问

- 程序查询模式

- 中断模式

- DMA模式

#### 中断

> 中断发生时，OS必须通过保存寄存器和程序计数器来保留CPU的状态，
>
> 分 轮询、向量中断系统，
>
> 将内核例程与用户例程分离，以决定每种类型的中断应该采取的动作。

- 中断通过中断向量表将控制传输给中断服务例程，中断向量表包括了所有设备服务例程的入口地址

- 中断体系结构必须保存中断指令的地址

- 当一个中断正被处理的时候，其他中断是被禁止的

- 陷阱是因错误或用户程序的特定请求所引起的软件生成中断

-  ==操作系统是中断驱动的==

#### DMA模式

- 用于高速I/O设备，使之以接近内存的速度进行信息传输
- 设备传输器以块为单位直接将数据从存储器传输到主存，而无须CPU的干预
- 每个数据块传输的时候只产生一个中断，而不是一个字节的传输就 会产生一个中断

## 硬件保护

### 双重模式操作

操作系统分用户模式和内核模式；

特权指令只能在内核[核心]模式下执行，非特权指令随意；

特权指令，如关机，在用户模式下无法执行；所有I/O指令均为特权指令；

特权指令的主要特征在于是否影响其它用户。

![image-20220301113037767](https://gitee.com/yzketx/image-markdown/raw/master/img/202203011130496.png)



用户态切换内核态通过 `trap` 实现：

**访管指令或陷阱指令（trap）**：

- CPU指令集中的一个特殊指令，只能在用户模式下执行，负责从用户模式切换到内核模式
- 当应用程序需要请求操作系统服务时，编译器会在发生系统调用时自动插入一条访管指令，CPU执行访管指令将产生一个访管中断(trap，自陷），然后启动相应的操作系统服务

#### 硬中断、陷阱与软中断

> 中断即外中断，是指来自处理机和内存外部的中断，包括I/O设备发出的I/O中断、外部信号中断、各种定时器引起的时钟中断及调试程序中设置的断点等引起的调试中断等。陷阱即内中断，主要是指在处理机和内存内部产生的中断。它包括程序运算引起的各种错误。软中断是通信进程之间用来模拟硬中断的一种信号通信方式。

==!==陷入与硬件中断的不同：

​	① 陷阱通常由处理机正在执行的现行指令引起，而中断则是由与现行指令无关的中断源引起的。

​	② 陷阱处理程序提供的服务为当前进程所用，而中断处理程序提供的服务则不是为了当前进程的。

​	③ CPU在执行完一条指令之后，下一条指令开始之前响应中断，而在一条指令执行中也可以响应陷阱。

​	④ 在有的系统中，陷入处理程序被规定在各自的进程上下文中执行，而中断处理程序则在系统上下文中执行。

==!==软中断与硬中断的比较的相同点：

​	中断源发中断请求或软中断信号后，CPU或接收进程在适当的时机自动进行中断处理或完成软中断信号所对应的功能。

==!==软中断与硬中断的不同点：

​	接收软中断信号的进程不一定正好在接收时占有处理机，而相应的处理必须等到该接收进程得到处理机之后才能进行。

### I/O保护

必须确保用户程序永远无法以monitor模式 获得计算机的控制权

### 内存保护



### CPU保护





分时系统

- 同时性
- 交互性
- 共享性
- 独占性



实时系统

- 对时钟管理高要求
- 可靠性
- 过载保护
- 
